const translations = {
    ru: {
        "home": "Главная страница",
        "tariffs": "Тарифы",
        "tariff": "Тариф",
        "cinerama": "Cinerama",
        "connect": "Подключить",
        "already_connected": "Уже подключили",
        "price": "Стоимость",
        "day_speed": "Дневная скорость",
        "night_speed": "Ночная скорость",
        "devices": "устройств",
        "apply": "Оставить заявку",
        "offer_conditions": "Не упусти возможность подключить тариф по выгодным условиям",
        "call": "Позвонить",
        "telegram": "Telegram",
        "subscription": "Подписка",
        "cinerama_description": "Cinerama.uz — это онлайн-платформа для просмотра фильмов, сериалов и мультфильмов в хорошем качестве, с доступом через TAS-IX.",
        "subscribe_now": "Подпишитесь сейчас",
        "channels": "ТВ каналов",
        "movies_series": "Фильмов и сериалов",
        "cartoons": "Мультфильмов",
        "uz_videos": "Уз видео",
        "langCode": "Ру",
        "router": "Роутер",
        "number": "Номер",
        "fromTillDevice": "до 11-12 устройств",
        "fio": "Ф.И.О.",
        "fastTariffs": "Скоростные тарифы с выгодой",
        "siteOffer": "Сайт предлагает подписку для удобного просмотра контента без рекламы, а также онлайн-телевидение.",
        "mbitPerS": "{{number}} Мбит/с",
        "currency": "{{number}} сум",
        "devicesCount": "до {{number}} устройств",
        "enterValidPhoneNumber": "Пожалуйста, введите действительный номер телефона.",
        "145DollarToMonth": "За 145 000 сум в месяц вы получаете",
        "fill_form": "Заполняя форму заявки на сайте, вы соглашаетесь с условиями публичной оферты и даете согласие на обработку ваших персональных данных в соответствии с действующим законодательством. Ваши данные будут использоваться исключительно в целях, связанных с оказанием услуг, и не будут переданы третьим лицам без вашего согласия.",
        "sentMessage": "Сообщение успешно отправлено"

    },
    uz: {
        "home": "Bosh sahifa",
        "tariffs": "Tariflar",
        "tariff": "Tariflar",
        "cinerama": "Cinerama",
        "connect": "Ulanish",
        "already_connected": "Allaqachon ulangan",
        "price": "Narxi",
        "day_speed": "Kunduzgi tezlik",
        "night_speed": "Tungi tezlik",
        "devices": "gacha qurilmalar",
        "apply": "Ariza qoldirish",
        "offer_conditions": "Qulay shartlar asosida tarifni ulash imkoniyatini boy bermang",
        "call": "Qo'ng'iroq qiling",
        "telegram": "Telegram",
        "subscription": "Obuna",
        "cinerama_description": "Cinerama.uz - yuqori sifatli filmlar, seriallar va multfilmlarni TAS-IX orqali tomosha qilish uchun onlayn platforma.",
        "subscribe_now": "Obuna bo'ling",
        "channels": "TV kanallar",
        "movies_series": "Filmlar va seriallar",
        "cartoons": "Multfilmlar",
        "uz_videos": "O'z videolar",
        "langCode": "Uz",
        "router": "Router",
        "number": "Nomer",
        "fromTillDevice": "11-12 ta qurilmagacha",
        "fio": "F.I.Sh",
        "fastTariffs": "Imtiyozli yuqori tezlikdagi tariflar",
        "siteOffer": "Sayt kontentni reklamasiz, shuningdek, onlayn televideniyeni qulay ko'rish uchun obunani taklif qiladi.",
        "mbitPerS": "{{number}} MBit/s",
        "currency": "{{number}} so'm",
        "devicesCount": "{{number}} qurilmalar",
        "enterValidPhoneNumber": "Iltimos telefon raqamini to'g'ri kiriting",
        "145DollarToMonth": "Oyiga 145 000 so'm evaziga siz quyidagilarga ega bo'lasiz",
        "fill_form": "Saytda ariza formasini to'ldirish orqali siz jamoatchilik taklifining shartlari bilan tanishganligingizni tasdiqlaysiz va shaxsiy ma'lumotlaringizni amaldagi qonunchilikka muvofiq qayta ishlashga rozilik bildirasiz. Sizning ma'lumotlaringiz faqat xizmatlar ko'rsatish bilan bog'liq maqsadlarda ishlatiladi va uchinchi shaxslarga sizning roziligingizsiz uzatilmaydi.",
        "sentMessage": "Xabar muvaffaqiyatli yuborildi"

    },
    en: {
        "home": "Home page",
        "tariffs": "Tariffs",
        "tariff": "Tariffs",
        "cinerama": "Cinerama",
        "connect": "Connect",
        "already_connected": "Already connected",
        "price": "Price",
        "day_speed": "Day speed",
        "night_speed": "Night speed",
        "devices": "devices",
        "apply": "Submit application",
        "offer_conditions": "Don't miss the chance to connect the tariff at favorable conditions",
        "call": "Call",
        "telegram": "Telegram",
        "subscription": "Subscription",
        "cinerama_description": "Cinerama.uz is an online platform for watching movies, TV series, and cartoons in high quality, with access through TAS-IX.",
        "subscribe_now": "Subscribe now",
        "channels": "TV channels",
        "movies_series": "Movies and TV series",
        "cartoons": "Cartoons",
        "uz_videos": "Uz videos",
        "langCode": "En",
        "router": "Router",
        "number": "Number",
        "fromTillDevice": "up to 11-12 devices",
        "fio": "Full name",
        "fastTariffs": "High-speed tariffs with benefits",
        "siteOffer": "The website offers a subscription for convenient content viewing without ads, as well as online TV.",
        "mbitPerS": "{{number}} Mbps",
        "currency": "{{number}} sum",
        "devicesCount": "up to {{number}} devices",
        "enterValidPhoneNumber": "Please enter a valid phone number.",
        "145DollarToMonth": "For 145,000 sum per month, you get the following",
        "fill_form": "By filling out the application form on the website, you agree to the terms of the public offer and consent to the processing of your personal data in accordance with applicable legislation. Your data will be used exclusively for service-related purposes and will not be transferred to third parties without your consent.",
        "sentMessage": "Message sent successfully"
    }
};


// Load translations from JSON files (use fetch or hard-coded JSON)
async function loadTranslations(lang) {
    return translations?.[lang];
}

async function changeLanguage(lang) {
    // Get the current language from localStorage or default to 'uz'
    let currentLang = localStorage.getItem('language132465') || 'uz';

    // Determine the opposite language
    const newLang = currentLang === 'uz' ? 'ru' : currentLang === 'ru' ? 'en' : 'uz';

    // Load the translations for the new language
    const dictionary = await loadTranslations(newLang);

    // Apply the translations to the page
    applyTranslations(dictionary);

    // Update the lang attribute in the <html> element
    document.documentElement.setAttribute("lang", newLang);

    // Save the new language in localStorage
    localStorage.setItem('language132465', newLang);
    window.location.reload()
}

function applyTranslations(dictionary) {
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');

        const translatedText = dictionary[key] || element.textContent;
        const options = element.getAttribute('data-i18n-options');

        if (options) {
            try {
                const optionsObj = JSON.parse(options);
                if (optionsObj && optionsObj.number && translatedText.includes("{{number}}")) {
                    // Example: format the number in translation
                    element.textContent = translatedText.replace("{{number}}", optionsObj.number);
                }
            } catch (error) {
                console.error("Invalid JSON in data-i18n-options:", error);
            }
        } else {
            element.textContent = translatedText;
        }
        if (element.hasAttribute('placeholder')) {
            const placeholderKey = `${key}`; // Use a separate key for placeholders
            const translatedPlaceholder = dictionary[placeholderKey] || element.getAttribute('placeholder');
            element.setAttribute('placeholder', translatedPlaceholder);
        }
    });
}

document.addEventListener('DOMContentLoaded', async () => {
    // Check if language is already stored in localStorage, otherwise default to 'uz'
    const currentLang = localStorage.getItem('language132465') || 'uz';
    // Load the translations for the current language
    const dictionary = await loadTranslations(currentLang);
    // Apply the translations to the page
    applyTranslations(dictionary);
    // Set the lang attribute in the <html> element to the current language
    document.documentElement.setAttribute("lang", currentLang);
});